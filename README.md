# Financial-Pridict-Modelling
My final project
## 主要idea
modelling产生predict，通过predict的值和实际的值表现出我们stategy的好处

## main 函数返回的东西
'''

    ########此文件供前后端直接调用，来对模型进行训练和预测
    # lstm_train()
    mse_train, mse_test, y_train, train_pred, y_test, test_pred, mtr = predict('randomforest')
  
    print('!MSE ON TRAIN:'+str(mse_train))
    print('!MSE ON TEST:'+str(mse_test))
  
'''
然后这个运行就是产生这样的图片，就是看你预测的和实际的区别，当然后续也有其他的功能但我还没开始。
![image](https://github.com/hyt27/Financial-Pridict-Modelling/assets/74773913/56dafe64-f50a-424f-acac-e8be44b70d89)
## 参数描述
predict函数不是返回了这么多参数吗，我把这些参数打印出来：

* mse_train: 0.00012435772731710378
  
* mse_test: 5.199904383605103e-05
  
* y_train:
 [[-0.83777453]
 [-0.87666532]
 [-0.868155  ]
 ...
 [-0.29274355]
 [-0.30126253]
 [-0.29158689]]

* train_pred: 
[-0.83458791 -0.86500523 -0.87256013 ... -0.2909271  -0.30271816 -0.29501827]

* y_test: 
[[-0.20591803]
 [-0.19976202]
 [-0.19323285]
 ...
 [-0.29274355]
 [-0.30126253]
 [-0.29158689]]
* test_pred: 
[-0.21340489 -0.20049463 -0.19272365 ... -0.2909271  -0.30271816
 -0.29501827]
* mtr: 
[[-0.79667562]
 [-0.79146965]
 [-0.79724886]
 ...
 [-0.29274355]
 [-0.30126253]
 [-0.29158689]]

### 分别代表
y_train：训练集的实际目标值。它是一个一维数组，包含训练数据的目标变量的真实值。

train_pred：训练集的预测目标值。它是一个一维数组，包含训练数据的目标变量的预测值。

y_test：测试集的实际目标值。它是一个一维数组，包含测试数据的目标变量的真实值。

test_pred：测试集的预测目标值。它是一个一维数组，包含测试数据的目标变量的预测值。

mtr：用于训练和测试的经过缩放和转换的数据。它是一个二维数组，表示输入特征。其中存储了经过缩放和转换后的时间序列数据，可以用于训练机器学习模型。每一行代表一个时间步，每一列代表一个特征。

#### mtr具体代码
df长这样

      Date Close                    
      2013-01-04  2276.991943
      2013-01-07  2285.364014
      2013-01-08  2276.070068
      2013-01-09  2275.340088
      2013-01-10  2283.656982
                      ...
      2022-12-26  3065.562988
      2022-12-27  3095.570068
      2022-12-28  3087.399902
      2022-12-29  3073.699951
      2022-12-30  3089.260010
      
      [2427 rows x 1 columns]

然后mtr经过归一化转换

        df = pd.read_csv(csv_file_path)
        df['Date'] = pd.to_datetime(df['Date'])
        df.set_index('Date', inplace=True)
        scaler = MinMaxScaler(feature_range=(-1, 1))
        mtr = scaler.fit_transform(df.values)
